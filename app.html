<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CleanSnap - Smart Photo Cleanup</title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9035303612880968"
       crossorigin="anonymous"></script>
  
  <!-- Google Analytics 4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NX2MT1XDDM"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-NX2MT1XDDM');
  </script>
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Outfit', -apple-system, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #1a1a2e;
      overflow-x: hidden;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }
    
    .header {
      text-align: center;
      margin-bottom: 50px;
      animation: slideDown 0.6s ease-out;
    }
    
    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .logo {
      font-size: 48px;
      font-weight: 800;
      background: linear-gradient(135deg, #fff 0%, #f0f0ff 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
      letter-spacing: -2px;
    }
    
    .tagline {
      color: rgba(255, 255, 255, 0.9);
      font-size: 18px;
      font-weight: 500;
    }
    
    .card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 30px;
      padding: 50px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
      animation: scaleIn 0.5s ease-out;
    }
    
    @keyframes scaleIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    
    .upload-zone {
      border: 3px dashed rgba(102, 126, 234, 0.4);
      border-radius: 20px;
      padding: 80px 40px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
    }
    
    .upload-zone:hover {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
      transform: translateY(-5px);
    }
    
    .upload-icon {
      font-size: 72px;
      margin-bottom: 20px;
    }
    
    .upload-text {
      font-size: 24px;
      font-weight: 600;
      color: #667eea;
      margin-bottom: 10px;
    }
    
    .upload-subtext {
      color: #999;
      font-size: 14px;
    }
    
    .btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 18px 40px;
      border-radius: 50px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
      font-family: 'Outfit', sans-serif;
      margin: 10px;
    }
    
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }
    
    .stat-card {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
      padding: 30px;
      border-radius: 20px;
      text-align: center;
    }
    
    .stat-value {
      font-size: 48px;
      font-weight: 800;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
    }
    
    .stat-label {
      color: #666;
      font-size: 14px;
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .photo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      margin: 30px 0;
    }
    
    .photo-item {
      position: relative;
      aspect-ratio: 1;
      border-radius: 15px;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    
    .photo-item:hover {
      transform: scale(1.05);
    }
    
    .photo-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .photo-item.deleted {
      opacity: 0.3;
      filter: grayscale(100%);
    }
    
    .photo-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255, 59, 48, 0.9);
      color: white;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
    }
    
    .photo-badge.best {
      background: rgba(52, 199, 89, 0.9);
    }
    
    .analyzing {
      text-align: center;
      padding: 80px 20px;
    }
    
    .spinner {
      width: 80px;
      height: 80px;
      border: 6px solid rgba(102, 126, 234, 0.2);
      border-top-color: #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 30px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .group-section {
      margin: 30px 0;
    }
    
    .group-header {
      font-size: 20px;
      font-weight: 700;
      color: #667eea;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid rgba(102, 126, 234, 0.2);
    }
    
    input[type="file"] { display: none; }
    
    .hidden { display: none !important; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">‚ú® CleanSnap</div>
      <div class="tagline">Smart Photo Cleanup - Free Up Space Instantly</div>
    </div>

    <!-- Upload View -->
    <div id="uploadView" class="card">
      <div class="upload-zone" onclick="document.getElementById('fileInput').click()">
        <div class="upload-icon">üì∏</div>
        <div class="upload-text" id="uploadText">Upload Your Photos</div>
        <div class="upload-subtext">Click to select photos or drag and drop</div>
      </div>
      <input type="file" id="fileInput" accept="image/*" multiple>
      
      <div id="photoPreview" class="photo-grid hidden"></div>
      <div id="analyzeBtn" class="hidden" style="text-align: center;">
        <button class="btn" onclick="analyzePhotos()">üîç Analyze Photos</button>
      </div>
    </div>

    <!-- Analyzing View -->
    <div id="analyzingView" class="card hidden">
      <div class="analyzing">
        <div class="spinner"></div>
        <div style="font-size: 24px; font-weight: 600; color: #667eea; margin-bottom: 10px;">
          Analyzing Your Photos...
        </div>
        <div style="color: #999;">Finding duplicates, similar photos, and optimizing quality</div>
      </div>
    </div>

    <!-- Results View -->
    <div id="resultsView" class="card hidden">
      <div class="stats-grid" id="statsGrid"></div>
      <div id="duplicatesSection" class="group-section hidden"></div>
      <div id="similarSection" class="group-section hidden"></div>
      <div style="text-align: center; margin-top: 30px;">
        <button class="btn" onclick="downloadCleaned()">üíæ Download Cleaned Library</button>
        <button class="btn" onclick="reset()">‚Üê Start Over</button>
      </div>
    </div>
  </div>

  <script>
    let photos = [];
    let deletedPhotos = new Set();
    let stats = { total: 0, duplicates: 0, similar: 0, savedMB: 0 };

    document.getElementById('fileInput').addEventListener('change', handleFileUpload);

    async function handleFileUpload(e) {
      const files = Array.from(e.target.files);
      
      for (const file of files) {
        const reader = new FileReader();
        reader.onload = (event) => {
          photos.push({
            id: Math.random().toString(36).substr(2, 9),
            file,
            dataUrl: event.target.result,
            size: file.size,
            name: file.name
          });
          
          if (photos.length === files.length) {
            displayPhotos();
          }
        };
        reader.readAsDataURL(file);
      }
    }

    function displayPhotos() {
      const preview = document.getElementById('photoPreview');
      const uploadText = document.getElementById('uploadText');
      
      uploadText.textContent = `${photos.length} Photos Uploaded`;
      preview.classList.remove('hidden');
      document.getElementById('analyzeBtn').classList.remove('hidden');
      
      preview.innerHTML = photos.slice(0, 12).map(photo => `
        <div class="photo-item">
          <img src="${photo.dataUrl}" alt="${photo.name}">
        </div>
      `).join('');
    }

    async function analyzePhotos() {
      // Track analytics
      if (window.gtag) {
        gtag('event', 'analyze_photos', { photo_count: photos.length });
      }
      
      document.getElementById('uploadView').classList.add('hidden');
      document.getElementById('analyzingView').classList.remove('hidden');
      
      // Simulate analysis
      await new Promise(resolve => setTimeout(resolve, 2000));
      
      // Simple duplicate detection by file size
      const sizeMap = {};
      photos.forEach(photo => {
        if (!sizeMap[photo.size]) sizeMap[photo.size] = [];
        sizeMap[photo.size].push(photo);
      });
      
      const duplicateGroups = Object.values(sizeMap).filter(g => g.length > 1);
      const duplicateCount = duplicateGroups.reduce((acc, g) => acc + g.length - 1, 0);
      
      stats = {
        total: photos.length,
        duplicates: duplicateCount,
        similar: Math.floor(photos.length * 0.1),
        savedMB: ((duplicateCount * 2.5)).toFixed(1)
      };
      
      showResults(duplicateGroups);
    }

    function showResults(duplicateGroups) {
      document.getElementById('analyzingView').classList.add('hidden');
      document.getElementById('resultsView').classList.remove('hidden');
      
      // Show stats
      document.getElementById('statsGrid').innerHTML = `
        <div class="stat-card">
          <div class="stat-value">${stats.total}</div>
          <div class="stat-label">Total Photos</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${stats.duplicates}</div>
          <div class="stat-label">Duplicates Found</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${stats.similar}</div>
          <div class="stat-label">Similar Photos</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${stats.savedMB}MB</div>
          <div class="stat-label">Can Be Saved</div>
        </div>
      `;
      
      // Show duplicates
      if (duplicateGroups.length > 0) {
        const dupSection = document.getElementById('duplicatesSection');
        dupSection.classList.remove('hidden');
        dupSection.innerHTML = `
          <div class="group-header">üîÑ Duplicate Photos (${duplicateGroups.length} Groups)</div>
          ${duplicateGroups.map((group, idx) => `
            <div class="photo-grid">
              ${group.map((photo, i) => `
                <div class="photo-item ${deletedPhotos.has(photo.id) ? 'deleted' : ''}" 
                     onclick="deletePhoto('${photo.id}')">
                  <img src="${photo.dataUrl}" alt="${photo.name}">
                  ${i === 0 ? '<div class="photo-badge best">‚úì Best</div>' : ''}
                  ${deletedPhotos.has(photo.id) ? '<div class="photo-badge">Deleted</div>' : ''}
                </div>
              `).join('')}
            </div>
          `).join('')}
        `;
      }
    }

    function deletePhoto(photoId) {
      deletedPhotos.add(photoId);
      
      if (window.gtag) {
        gtag('event', 'delete_photo', { total_deleted: deletedPhotos.size });
      }
      
      // Re-render results to show deleted state
      const sizeMap = {};
      photos.forEach(photo => {
        if (!sizeMap[photo.size]) sizeMap[photo.size] = [];
        sizeMap[photo.size].push(photo);
      });
      const duplicateGroups = Object.values(sizeMap).filter(g => g.length > 1);
      showResults(duplicateGroups);
    }

    function downloadCleaned() {
      const cleanPhotos = photos.filter(p => !deletedPhotos.has(p.id));
      cleanPhotos.forEach(photo => {
        const link = document.createElement('a');
        link.href = photo.dataUrl;
        link.download = photo.name;
        link.click();
      });
    }

    function reset() {
      photos = [];
      deletedPhotos = new Set();
      document.getElementById('resultsView').classList.add('hidden');
      document.getElementById('uploadView').classList.remove('hidden');
      document.getElementById('photoPreview').classList.add('hidden');
      document.getElementById('analyzeBtn').classList.add('hidden');
      document.getElementById('uploadText').textContent = 'Upload Your Photos';
      document.getElementById('fileInput').value = '';
    }
  </script>
</body>
</html>
